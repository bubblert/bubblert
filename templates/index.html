{% include 'base.html' %}

{% block content %}
    <section class="home">
        <div class="container">
            <div class="row" id="categories">
            </div>
        </div>
    </section>
{% endblock content %}

{% block additionaljs %}
    <script src="libs/typed.min.js"></script>
    <script async>
        let allNews = [];
        $(document).ready(function () {
            let socket = io.connect('http://' + document.domain + ':' + location.port);
            socket.on('connect', function () {
                socket.emit('start_news_stream');
            });

            socket.on('news_add', function (data) {
                allNews = data;
                allNews.forEach(function (item) {
                    let val = `<a href="/zoom/${item.item_id}">${item.headline}</a>`
                    let div = `<div id="${item.item_id}" class="col-sm-4 first home__category"> ${val} </div>`;
                    console.log(div);
                    $('#categories').prepend($(div));
                });


                let colors = ['#335557', '#57A473', '#E7CB63', '#F6981A', '#E2693F']
                $('.home__category').each(function (i, obj) {
                    $(obj).css("background", colors[i++ % colors.length]);
                });


                {#                #}
                {#                $('.home__category').each(function (index) {#}
                {#                    if (index < allNews.length && index !== 0) {#}
                {#                        $(this).html(`<a href="/zoom/${allNews[index].item_id}">${allNews[index].headline}</a>`)#}
                {#                    } else {#}
                {#                        $(this).text("")#}
                {#                    }#}
                {#                })#}
                {#                new Typed('.first', {#}
                {#                    strings: [allNews[0].headline],#}
                {#                    typeSpeed: 30,#}
                {#                    onComplete: () => $('.first').html(`<a href="/zoom/${allNews[0].item_id}">${allNews[0].headline}</a>`)#}
                {#                });#}
            });
        });

<<<<<<< HEAD
        let colors = ['#77CBB9', '#57A473', '#E7CB63', '#468472', '#BCD179']
        $('.home__category').each(function(i, obj) {
            $(obj).css("background", colors[i++ % colors.length]);
        });
=======
>>>>>>> d986560d0fc14f996e8d82bbba118d755d36a238

    </script>
{% endblock additionaljs %}
